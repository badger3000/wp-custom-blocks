document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".calculator-block").forEach((function(e){const t=e.querySelector(".calculator-block__form"),a=e.querySelector(".calculator-block__results");t&&a&&t.addEventListener("submit",(function(e){e.preventDefault();const n=t.querySelector('[data-input="balance-owed"]'),r=t.querySelector('[data-input="interest-rate"]'),o=t.querySelector('[data-input="debt-type"]'),l=t.querySelector('[data-input="monthly-payment"]'),c=t.querySelector('[data-input="user-email"]'),u=parseFloat(n.value)||0,s=parseFloat(r.value)||0,d=o.value,i=parseFloat(l.value)||0,p=c?c.value.trim():"",y=s/100/12;let m=u,h=0,b=0;for(;m>0&&h<1200;){const e=m*y,t=Math.min(i-e,m);if(i<=e)return void alert("Monthly payment must be higher than the monthly interest: $"+e.toFixed(2));b+=e,m-=t,h++,m<.01&&(m=0)}const S=e=>"$"+parseFloat(e).toFixed(2);if(a.querySelector('[data-result="monthly-payment"]').textContent=S(i),a.querySelector('[data-result="months-to-pay"]').textContent=h,a.querySelector('[data-result="total-principal"]').textContent=S(u),a.querySelector('[data-result="total-interest"]').textContent=S(b),""!==p){const e=new FormData;e.append("action","send_calculator_results"),e.append("nonce",window.calculatorData?.nonce||""),e.append("email",p),e.append("balance",u),e.append("interest",s),e.append("debtType",d),e.append("monthly",i),e.append("months",h),e.append("principal",u),e.append("totalInterest",b),fetch(window.calculatorData?.ajaxurl||"/wp-admin/admin-ajax.php",{method:"POST",credentials:"same-origin",body:e}).then((e=>e.json())).then((e=>{e.success?alert("Results have been sent to your email!"):alert("Failed to send email: "+(e.data||"Please try again."))})).catch((e=>{console.error("Error:",e),alert("Failed to send email. Please try again.")}))}a.setAttribute("aria-busy","false")}))}))}));